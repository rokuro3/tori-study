# ä½œæ¥­ãƒ­ã‚°: FastAPIå®Ÿè£…ã¨ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆå¯¾å¿œ

**æ—¥ä»˜**: 2026-01-16

## å®Ÿæ–½å†…å®¹

### 1. mokuroku8.csvã®è§£æã¨å¤‰æ›
- `birdVoiceSearch/mokuroku8.csv`ã‚’è§£æã—ã€æ§‹é€ åŒ–ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›
- ä½œæˆãƒ•ã‚¡ã‚¤ãƒ«: `api/parse_mokuroku.py`
- å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«:
  - `birdVoiceSearch/mokuroku_parsed.pickle`
  - `birdVoiceSearch/mokuroku_parsed.json`
- è§£æçµæœ:
  - ç·ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°: 1,137ä»¶
  - ç¨®ï¼ˆäºœç¨®ã‚’é™¤ãï¼‰: 692ç¨®
  - äºœç¨®: 445ä»¶
  - ç§‘ã®æ•°: 91ç§‘
  - ç›®ã®æ•°: 25ç›®

### 2. FastAPIå®Ÿè£…ã®æ”¹å–„
- `api/main.py`ã‚’æ›´æ–°ã—ã€ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’å®Ÿè£…:

#### ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆæ©Ÿèƒ½
- Xeno-Canto APIã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’10ç§’ã«1å›ã«åˆ¶é™
- `RateLimiter`ã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…
- `/api/rate-limit/status`ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆçŠ¶æ…‹ã‚’ç¢ºèªå¯èƒ½

#### æ—¥æœ¬å›½å†…ã®éŸ³å£°ãƒ‡ãƒ¼ã‚¿å„ªå…ˆ
- Bird Researchã®ãƒ‡ãƒ¼ã‚¿ã‚’å„ªå…ˆä½¿ç”¨ï¼ˆã™ã¹ã¦æ—¥æœ¬å›½å†…ã®éŸ³å£°ï¼‰
- Xeno-Cantoã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã¯`cnt:japan`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æ—¥æœ¬å›½å†…ã«é™å®š

#### ç§‘åã«åŸºã¥ã„ãŸé¸æŠè‚¢ç”Ÿæˆ
- `mokuroku_parsed.pickle`ã‚’ä½¿ç”¨ã—ã¦ç§‘åæƒ…å ±ã‚’å–å¾—
- åŒã˜ç§‘ã‹ã‚‰ä¸æ­£è§£ã®é¸æŠè‚¢ã‚’é¸å‡º
- åŒã˜ç§‘ã®ç¨®ãŒ3ç¨®æœªæº€ã®å ´åˆã¯ä»–ã®ç§‘ã‹ã‚‰è£œå®Œ

### 3. APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€è¦§

| ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | ãƒ¡ã‚½ãƒƒãƒ‰ | èª¬æ˜ |
|---------------|---------|------|
| `/` | GET | ãƒ«ãƒ¼ãƒˆ |
| `/api/health` | GET | ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ |
| `/api/species` | GET | é³¥ã®ç¨®åä¸€è¦§å–å¾— |
| `/api/families` | GET | ç§‘ã®ä¸€è¦§å–å¾— |
| `/api/quiz/question` | GET | ã‚¯ã‚¤ã‚ºå•é¡Œç”Ÿæˆ |
| `/api/quiz/answer` | POST | ã‚¯ã‚¤ã‚ºå›ç­”é€ä¿¡ |
| `/api/search` | POST | é³¥ã®éŸ³å£°æ¤œç´¢ |
| `/api/bird/{species_name}` | GET | é³¥ã®è©³ç´°æƒ…å ±å–å¾— |
| `/api/rate-limit/status` | GET | ãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆçŠ¶æ…‹ç¢ºèª |

### 4. å‹•ä½œç¢ºèªçµæœ

#### ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
```json
{
  "status": "healthy",
  "data_loaded": {
    "mokuroku": true,
    "mokuroku_parsed": true,
    "suntory": true,
    "bird_research": true
  },
  "rate_limiter": {
    "next_request_wait": 0
  }
}
```

#### ã‚¯ã‚¤ã‚ºå•é¡Œç”Ÿæˆãƒ†ã‚¹ãƒˆ
```json
{
  "question_id": "q_1768562481_6250",
  "audio_source": "bird-research",
  "audio_url": "https://www.bird-research.jp/1_shiryo/koe/toratsugumi_141231_utsunomiya_hirano.mp3",
  "family": "ãƒ„ã‚°ãƒŸç§‘",
  "choices": ["ã‚¦ã‚¿ãƒ„ã‚°ãƒŸ", "ã‚ªã‚¬ã‚µãƒ¯ãƒ©ã‚¬ãƒ“ãƒãƒ§ã‚¦", "ãƒˆãƒ©ãƒ„ã‚°ãƒŸ", "ãƒãƒã‚¸ãƒ§ã‚¦ãƒ„ã‚°ãƒŸ"],
  "correct_answer": "ãƒˆãƒ©ãƒ„ã‚°ãƒŸ",
  "location": "æ ƒæœ¨çœŒå®‡éƒ½å®®"
}
```

#### å›ç­”ãƒ†ã‚¹ãƒˆ
- æ­£è§£æ™‚: `{"is_correct": true, "message": "æ­£è§£ï¼ğŸ‰"}`
- ä¸æ­£è§£æ™‚: `{"is_correct": false, "message": "æ®‹å¿µ... æ­£è§£ã¯ã€Œãƒˆãƒ©ãƒ„ã‚°ãƒŸã€ã§ã—ãŸ"}`

## ä½œæˆãƒ»æ›´æ–°ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

| ãƒ•ã‚¡ã‚¤ãƒ« | æ“ä½œ |
|---------|------|
| `api/main.py` | æ›´æ–°ï¼ˆãƒ¬ãƒ¼ãƒˆãƒªãƒŸãƒƒãƒˆã€æ—¥æœ¬éŸ³å£°å¯¾å¿œï¼‰ |
| `api/parse_mokuroku.py` | æ–°è¦ä½œæˆ |
| `api/requirements.txt` | æ–°è¦ä½œæˆ |
| `api/Dockerfile` | æ–°è¦ä½œæˆ |
| `birdVoiceSearch/mokuroku_parsed.pickle` | æ–°è¦ä½œæˆ |
| `birdVoiceSearch/mokuroku_parsed.json` | æ–°è¦ä½œæˆ |
| `docs/infrastructure.md` | æ›´æ–°ï¼ˆFastAPIãƒ‡ãƒ—ãƒ­ã‚¤å…ˆè¿½åŠ ï¼‰ |

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

- [ ] ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆNext.jsï¼‰ã¨APIã®é€£æº
- [ ] Supabaseã¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼é€£æº
- [ ] ã‚¹ã‚³ã‚¢è¨˜éŒ²æ©Ÿèƒ½ã®å®Ÿè£…
- [ ] FastAPIã®ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆRailway/Render/Fly.ioï¼‰
